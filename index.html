<!doctype html>
<html lang="en" data-bs-theme="auto">

<head>
  <meta name="author" content="Miguel Cebrian">
  <title>Configurations</title>
  <link href="./assets/css/bootstrap.min.css" rel="stylesheet">
  <link rel="icon" type="image/png" href="./assets/img/icon.png">
  <style>
    .aog-bg {
      --bs-bg-opacity: 1;
      background-color: rgba(var(--bs-secondary-bg-rgb), var(--bs-bg-opacity)) !important;
    }

    .aog-bg-tab.active {
      --bs-bg-opacity: 1;
      background-color: rgba(var(--bs-secondary-bg-rgb), var(--bs-bg-opacity)) !important;
    }

    span.input-group-text {
      font-weight: bolder !important;
      border: 0 !important;
      background-color: var(--bs-white);
      flex: 0 0 auto;
    }

    form>div.input-group>select {
      max-width: 300px;
    }

    form>div.input-group>input.form-control {
      border: 0 !important;
      flex: 0 0 auto;
      width: 33.33333333%;
    }
  </style>
</head>

<body>



  <header class="navbar sticky-top bg-primary text-white px-4">
    <a class="navbar-brand p-0 me-0 me-lg-2" href="./index.html" aria-label="Bootstrap">
      <img height="128px" src="./assets/img/logo.png">
    </a>
    <p class="fw-bolder fs-1">AgOpenGPS </p>
    <p class="fw-light ms-4 flex-grow-1">Configurations</p>
  </header>

  <main class="container mt-4">


    <form id="search-form">
      <div class="input-group">
        <span class="input-group-text">Discourse:</span>
        <input type="text" aria-label="Discourse" class="form-control" placeholder="Discourse Name" id="sDiscourse">
        <span class="input-group-text">Telegram:</span>
        <input type="text" aria-label="Telegram" class="form-control" placeholder="Telegram Name" id="sTelegram">
      </div>
      <div class="input-group">
        <span class="input-group-text">Brand:</span>
        <select class="form-select" id="iBrandFilter" max-width="200">
          <option selected>Choose...</option>
        </select>
        <span class="input-group-text">V. Model:</span>
        <input type="text" aria-label="Model" class="form-control" placeholder="ie. 6S.155..." id="sModel"
          max-width="100">

        <span class="input-group-text">WAS. type:</span>
        <input type="text" aria-label="was" class="form-control" placeholder="ie. RHQ0013..." id="sWas">

      </div>

      <div class="input-group mt-2" id="PCBFilter">
        <span class="input-group-text bg-info">PCB type:</span>
      </div>

      <div class="input-group mt-2" id="DriverFilter">
        <span class="input-group-text bg-info">Driver:</span>
      </div>

      <div class="input-group mt-2" id="ControllerFilter">
        <span class="input-group-text bg-info">Controller:</span>
      </div>

      <button type="button" class="btn btn-primary my-4" id="btn-search">Search<span class="ms-4"><svg width="20"
            height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20">
            <path
              d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z"
              stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round">
            </path>
          </svg></span></button>
    </form>

    <table class="table table-striped table-hover data-table d-none">
      <thead class="table-dark">
        <tr>
          <th scope="col">Discourse</th>
          <th scope="col">Telegram</th>
          <th scope="col">Brand</th>
          <th scope="col">Model</th>
          <th scope="col">WAS</th>
          <th scope="col">PCB</th>
          <th scope="col">Driver</th>
          <th scope="col">Controller</th>
        </tr>
      </thead>
      <tbody id="data-table"></tbody>
    </table>


  </main>

  <!-- Modal -->
  <div class="modal fade" id="recordModal" tabindex="-1" aria-labelledby="RecordModal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5">Configuration Record </h1>
          <p class="fs-6 ms-4" id="recno"></p>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="alert alert-danger" id="errorAlert" style="display: none;" role="alert">
          </div>
          <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link aog-bg-tab  border-bottom-0" id="wheel-tab" data-bs-toggle="tab"
                data-bs-target="#wheel-tab-pane" type="button" role="tab" aria-controls="whell-tab-pane"
                aria-selected="true"><img height="48px" src="./assets/img/wheel.png"></button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link aog-bg-tab border-bottom-0 pb-2" id="pot-tab" data-bs-toggle="tab"
                data-bs-target="#pot-tab-pane" type="button" role="tab" aria-controls="pot-tab-pane"
                aria-selected="false"><img height="48px" src="./assets/img/pot.png"></button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link aog-bg-tab border-bottom-0" id="stanley-tab" data-bs-toggle="tab"
                data-bs-target="#stanley-tab-pane" type="button" role="tab" aria-controls="stanley-tab-pane"
                aria-selected="false"><img height="48px" src="./assets/img/stanley.png"></button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link aog-bg-tab border-bottom-0" id="pp-tab" data-bs-toggle="tab"
                data-bs-target="#pp-tab-pane" type="button" role="tab" aria-controls="pp-tab-pane"
                aria-selected="false"><img height="48px" src="./assets/img/pp.png"></button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link active aog-bg-tab border-bottom-0" id="ad-tab" data-bs-toggle="tab"
                data-bs-target="#ad-tab-pane" type="button" role="tab" aria-controls="ad-tab-pane"
                aria-selected="false"><img height="48px" src="./assets/img/fileMenu.png"></button>
            </li>
          </ul>
          <div class="tab-content aog-bg" id="myTabContent">
            <div class="tab-pane fade" id="wheel-tab-pane" role="tabpanel" aria-labelledby="wheel-tab" tabindex="0">
              <div class="d-flex justify-content-between">
                <span class="text-center mx-5 flex-grow-1">

                  <p class="fs-6 pt-3 m-0">WAS Zero
                    <span class="value-label" id="was-value"></span>
                  </p>
                  <p class="fs-6 pt-3 m-0">This is specific to your machine. Set accordingly.</p>

                  <p class="fs-6 pt-3 m-0">Counts per Degree
                    <span class="value-label" id="cpd-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="cpd" min="1" max="255">

                  <p class="fs-6 pt-3 m-0">Ackermann
                    <span class="value-label" id="ackermann-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="ackermann" min="1" max="200">

                  <p class="fs-6 pt-3 m-0">Max Steer Angle
                    <span class="value-label" id="msa-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="msa" min="10" max="80">
                </span>
                <span class="mt-4 mx-3">
                  <img src="./assets/img/wheelData.png">
                </span>
              </div>
            </div>
            <div class="tab-pane fade" id="pot-tab-pane" role="tabpanel" aria-labelledby="pot-tab" tabindex="0">
              <div class="d-flex justify-content-between">
                <span class="text-center mx-5 flex-grow-1">
                  <p class="fs-4 fw-bold">Motor or Hydraulic Gain</p>

                  <p class="fs-6 pt-3 m-0">Proportional Gain
                    <span class="value-label" id="pg-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="pg" min="0" max="200">

                  <p class="fs-6 pt-3 m-0">Maximum Limit
                    <span class="value-label pt-6" id="ml-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="ml" min="0" max="254">

                  <p class="fs-6 pt-3 m-0">Minimum to move
                    <span class="value-label" id="mm-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="mm" min="0" max="100">
                </span>
                <span class="mt-0 mx-3">
                  <img src="./assets/img/potData.png">
                </span>
              </div>
            </div>

            <div class="tab-pane fade" id="stanley-tab-pane" role="tabpanel" aria-labelledby="stanley-tab" tabindex="0">
              <div class="d-flex justify-content-between">
                <span class="text-center mx-5 flex-grow-1">
                  <p class="fs-4 fw-bold text-warning">Stanley Gains</p>

                  <p class="fs-6 pt-4 m-0">Aggressiveness
                    <span class="value-label" id="sd-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="sd" min="0.1" max="4" step="0.1">

                  <p class="fs-6 pt-4 m-0">Overshoot Reduction
                    <span class="value-label" id="sh-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="sh" min="0.1" max="4" step="0.1">

                  <p class="fs-6 pt-4 m-0">Integral
                    <span class="value-label" id="si-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="si" min="0" max="100">
                </span>
                <span class="mt-3 mx-3">
                  <img src="./assets/img/stanleyData.png">
                </span>
              </div>
            </div>

            <div class="tab-pane fade" id="pp-tab-pane" role="tabpanel" aria-labelledby="pp-tab" tabindex="0">
              <div class="d-flex justify-content-between">
                <span class="text-center mx-5 flex-grow-1">
                  <p class="fs-4 fw-bold text-info">Pure Pursuit</p>

                  <p class="fs-6 pt-3 m-0">Acquire Look Ahead
                    <span class="value-label" id="ppala-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="ppala" min="1" max="5" step="0.1">

                  <p class="fs-6 pt-3 m-0">Hold Look Ahead
                    <span class="value-label" id="pphla-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="pphla" min="1" max="5" step="0.1">

                  <p class="fs-6 pt-3 m-0">Look Ahead Speed Gain
                    <span class="value-label" id="ppsg-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="ppsg" min="0.5" max="3" step="0.1">

                  <p class="fs-6 pt-3 m-0">Integral
                    <span class="value-label" id="ppi-value">50</span>
                  </p>
                  <input type="range" class="form-range" id="ppi" min="0" max="100">
                </span>
                <span class="mt-3 mx-3">
                  <img src="./assets/img/ppData.png">
                </span>
              </div>
            </div>
            <div class="tab-pane fade show active" id="ad-tab-pane" role="tabpanel" aria-labelledby="ad-tab"
              tabindex="0">
              <form class="p-4" id="record-form">
                <div class="row mb-3">
                  <label for="iDiscourse" class="col-sm-2 col-form-label">Discourse</label>
                  <div class="col-sm-10">
                    <input type="text" class="form-control" placeholder="Discourse User Name" id="iDiscourse">
                  </div>
                </div>
                <div class="row mb-3">
                  <label for="iTelegram" class="col-sm-2 col-form-label">Telegram</label>
                  <div class="col-sm-10">
                    <input type="text" class="form-control" placeholder="Telegram User Name" id="iTelegram">
                  </div>
                </div>

                <div class="row mb-3">
                  <label for="iBrand" class="col-sm-2 col-form-label">Brand</label>
                  <div class="col-sm-10">
                    <select class="form-select" id="iBrand">
                      <option selected>Choose...</option>
                    </select>
                  </div>
                </div>

                <div class="row mb-3">
                  <label for="iModel" class="col-sm-2 col-form-label">Model</label>
                  <div class="col-sm-10">
                    <input type="text" class="form-control" placeholder="ie. 6S.155..." id="iModel">
                  </div>
                </div>
                <div class="row mb-3">
                  <label for="iWas" class="col-sm-2 col-form-label">WAS type</label>
                  <div class="col-sm-10">
                    <input type="text" class="form-control" placeholder="ie. RHQ0013..." id="iWas">
                  </div>
                </div>
                <div class="input-group mb-3">
                  <label class="input-group-text" for="ipcb">PCB type</label>
                  <select class="form-select" id="ipcb">
                    <option selected>Choose...</option>
                  </select>
                </div>
                <div class="input-group mb-3">
                  <label class="input-group-text" for="iDriver">Driver</label>
                  <select class="form-select" id="iDriver">
                    <option selected>Choose...</option>
                  </select>
                </div>
                <div class="input-group mb-3">
                  <label class="input-group-text" for="iController">Drive controller</label>
                  <select class="form-select" id="iController">
                    <option selected>Choose...</option>
                  </select>
                </div>
                <div class="row mb-3">
                  <label for="iComm" class="col-sm-2 col-form-label">Comments</label>
                  <div class="col-sm-10">
                    <input type="text" class="form-control" placeholder="ie. Any short comment or piece of advise..."
                      id="iComm">
                  </div>
                </div>

                <div class="row mb-3">
                  <div class="form-floating">
                    <!-- <label for="iPassword" class="col-sm-2 col-form-label">Password</label> -->
                    <!-- <div class="col-sm-10"> -->
                    <input type="text" class="form-control" data-key="1" id="iPassword" placeholder="here" required>
                    <label for="iPassword">Password</label>
                    <p>Choose any password you like - it will be encrypted and stored in the database, and this record
                      can only be updated by supplying the same password. It's safe to use the same password for all
                      your machines.</p>
                    <!-- </div> -->
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="btn-close">Close</button>
          <button type="button" class="btn btn-primary" id="btn-save">Save changes<span class="ms-3"><svg
                xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-arrow-right-circle-fill" viewBox="0 0 16 16">
                <path
                  d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z" />
              </svg></span></button>
        </div>
      </div>
    </div>
  </div>

  <script src="./assets/js/bootstrap.bundle.min.js"></script>
  <script>
    //const urlstub = "https://aogdb.azurewebsites.net/api/";
    //const urlstub = "http://localhost:7071/api/";
    const urlstub = "http://192.168.1.94:5000/";
    document.querySelector("#btn-search").addEventListener("click", search);
    document.querySelector("#btn-save").addEventListener("click", save);

    function getParameterByName(name) {
      let regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
      results = regex.exec(location.search);
      return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    function save() {
      let f = document.querySelector("#record-form");
      if (f.iPassword.value == "") {
        showError("To save, you must choose a password.",5000);
        return;
      }

      // send it off - the password should never be retrieved to the form, so the back-end can handle the checking/rejection of valid pw
      //build the url to the specific record
      let url = urlstub + "updateDocument?id=" + document.querySelector("#recno").innerHTML;

      //build the json object from the form data
      let payload = {
        DiscourseID: f.iDiscourse.value,
        TelegramID: f.iTelegram.value,
        setBrand_Tbrand: f.iBrand.value,
        MachineModel: f.iModel.value,
        WASType: f.iWas.value,
        PCB: f.ipcb.value,
        Driver: f.iDriver.value,
        Controller: f.iController.value,
        Comments: f.iComm.value,
        password: f.iPassword.value
      };

      let data = new FormData();

      //send the data to the api
      fetch(url, {
        method: "POST",
        body: JSON.stringify(payload) //data
      })
        .then((res) => {
          if (!res.ok) {
            throw new Error("Password mismatch - you cannot update this record");
          }
          return res.json();
        })
        .then((data) => {
          console.log(JSON.stringify(payload));

          //close the modal
          document.querySelector("#btn-close").click();
        })
        .catch((error) => {
          showError(error, 5000);
          console.error
        }
        );
    }

    // Function to show the error message and auto-hide it after a few seconds
    function showError(message, duration) {
      const errorAlert = document.getElementById("errorAlert");
      errorAlert.textContent = message;
      errorAlert.style.display = "block";

      setTimeout(function () {
        errorAlert.style.display = "none";
      }, duration);
    }

    function search() {
      // from the form values create the json/url to request the data from the db
      let f = document.querySelector("#search-form");
      let url = urlstub + "getSummary?";
      if (f.sDiscourse.value) url += "DiscourseID=" + f.sDiscourse.value + "&";
      if (f.sTelegram.value) url += "TelegramID=" + f.sTelegram.value + "&";
      if (f.iBrandFilter.selectedIndex > 0) url += "setBrand_TBrand=" + f.iBrandFilter.value + "&";
      if (f.sModel.value) url += "MachineModel=" + f.sModel.value + "&";
      if (f.sWas.value) url += "WASType=" + f.sWas.value + "&";

      var els = f.querySelectorAll('.btn-check');
      els.forEach(ctrl => {
        if (ctrl.id.indexOf("sPCB") !== -1) {
          if (ctrl.checked) {
            url += "PCB=" + ctrl.value + "&"
          }
        }
      })
      // need to work out how we dynamically build the URL for our variable buttons (eg AIO, ACE, CANBUS etc)
      // how will we specify them - add only the ones that are ticked perhaps?
      //if (f.)
      // request data from the api with fetch, like:
      //CORS issue to solve
      const tableBody = document.querySelector("#data-table");
      tableBody.innerHTML = '';
      document.querySelector("table.data-table").classList.remove("d-none");

      fetch(url).then(r => r.json()) //converts the txt in json
        .then(d => {
          d.forEach(item => {
            tableBody.innerHTML += `
            <tr data-id="${item.uniqueID}">
            <td onclick="showRecord(${item.uniqueID})">${item.DiscourseID}</td>
            <td onclick="showRecord(${item.uniqueID})">${item.TelegramID}</td>
            <td onclick="showRecord(${item.uniqueID})">${item.setBrand_TBrand}</td>
            <td onclick="showRecord(${item.uniqueID})">${item.MachineModel}</td>
            <td onclick="showRecord(${item.uniqueID})">${item.WASType}</td>
            <td onclick="showRecord(${item.uniqueID})">${item.PCB}</td>
            <td onclick="showRecord(${item.uniqueID})">${item.Driver}</td>
            <td onclick="showRecord(${item.uniqueID})">${item.Controller}</td>
          </tr>`;

          })
        }).catch(console.error);

    }

    function showRecord(id) {
      //let url = urlstub + "getDetail?uniqueID=5"; // + id
      let url = urlstub + "getDetail?uniqueID=" + id;
      console.log(url);

      /* CORS issue to solve */
      fetch(url).then(r => r.json())
        .then(data => {
          //console.log(data);

          document.querySelector("#recno").innerHTML = data[0].uniqueID;
          document.querySelector("#iDiscourse").value = data[0].DiscourseID;
          document.querySelector("#iTelegram").value = data[0].TelegramID;
          // take into account if harvester, tractor etc here? Or not needed
          document.querySelector("#iBrand").value = data[0].setBrand_TBrand;
          document.querySelector("#iModel").value = data[0].MachineModel;
          document.querySelector("#iComm").value = data[0].Comments;
          document.querySelector("#iWas").value = data[0].WASType;

          // how to calculate the selectedIndex - can't store the number in case the models change order
          // will need to be a text match
          var children = document.querySelector("#ipcb").children;
          for (x = 0; x < children.length; x++) {
            if (children[x].text == data[0].PCB) {
              document.querySelector("#ipcb").selectedIndex = x;
            }
          }
          var children = document.querySelector("#iDriver").children;
          for (x = 0; x < children.length; x++) {
            if (children[x].text == data[0].Driver) {
              document.querySelector("#iDriver").selectedIndex = x;
            }
          }
          var children = document.querySelector("#iController").children;
          for (x = 0; x < children.length; x++) {
            if (children[x].text == data[0].Controller) {
              document.querySelector("#iController").selectedIndex = x;
            }
          }

          // these fields need scaled appropriately, and LABELLED
          // Steer
          //document.querySelector("#was").value = +data.setAS_wasOffset; // Offset is useless, discard it
          document.querySelector("#cpd").value = data[0].setAS_countsPerDegree;
          document.querySelector("#ackermann").value = data[0].setAS_ackerman;

          // PWM
          document.querySelector("#pg").value = data[0].setAS_Kp;
          document.querySelector("#ml").value = data[0].setAS_highSteerPWM;
          document.querySelector("#mm").value = data[0].setAS_minSteerPWM;
          document.querySelector("#msa").value = data[0].setVehicle_maxSteerAngle;

          // Stanley
          document.querySelector("#sd").value = data[0].stanleyDistanceErrorGain;
          document.querySelector("#sh").value = data[0].stanleyHeadingErrorGain;
          document.querySelector("#si").value = data[0].stanleyIntegralGainAB;

          // Pure Pursuit
          document.querySelector("#ppala").value = data[0].setVehicle_goalPointLookAhead;
          document.querySelector("#pphla").value = data[0].setVehicle_toolLookAheadOn;
          document.querySelector("#ppsg").value = data[0].setVehicle_goalPointLookAheadMult;
          document.querySelector("#ppi").value = data[0].purePursuitIntegralGainAB;

          document.querySelector("#iPassword").dataset.key = "NOT TELLING";

          updateAllSliders();
          
          //show modal
          const myModal = new bootstrap.Modal('#recordModal');
          myModal.show();
        }).catch(console.error);
    }

    (function () {
      //to check the parameters in the url
      if (getParameterByName("mode") === "1") {//the mode parameter could be used to diferenciate whether should be only view or could have also edit capabilities
        let id = getParameterByName("id");
        if (id) {
          //showR();//now is only dummy data due to the CORS issues in the db, the function to be called should be showRecord(id);

          //get data from db
          showRecord(id);
        }
      }
    })();

    function updateAllSliders() {
      var sliders = document.querySelectorAll('input[type="range"]');
      sliders.forEach(function (sl) {
        var label = document.querySelector("#" + sl.id + "-value");
        label.textContent = "(" + sl.value + ")";
      })

    }

    document.addEventListener('DOMContentLoaded', function () {
      var BrandElement = document.getElementById('iBrand');
      var BrandFilterElement = document.getElementById('iBrandFilter');
      var PCBElement = document.getElementById('ipcb');
      var PCBFilterElement = document.getElementById('PCBFilter');
      var driverElement = document.getElementById('iDriver');
      var driverFilterElement = document.getElementById('DriverFilter');
      var controllerElement = document.getElementById('iController');
      var controllerFilterElement = document.getElementById('ControllerFilter');

      // Make an AJAX request to the REST API and pull in the dynamic content
      fetch(urlstub + "getStaticInfo")
        .then(function (response) {
          if (response.ok) {
            return response.json();
          } else {
            throw new Error('Error occurred while fetching options from the API.');
          }
        })
        .then(function (data) {
          var counter = 1;
          // Process the response and populate the options
          data.Manufacturer.forEach(function (option) {
            var optionElement = document.createElement('option');
            optionElement.value = option;
            optionElement.textContent = option;
            BrandElement.appendChild(optionElement);

            // and again for the filter dropdown
            var optionElement = document.createElement('option');
            optionElement.value = option;
            optionElement.textContent = option;
            BrandFilterElement.appendChild(optionElement);

          });
          counter = 1;
          data.PCBType.forEach(function (option) {
            var optionElement = document.createElement('option');
            optionElement.value = option;
            optionElement.textContent = option;

            PCBElement.appendChild(optionElement);

            var checkboxElement = document.createElement('input');
            checkboxElement.type = 'checkbox';
            checkboxElement.className = 'btn-check';
            checkboxElement.id = 'btn-check-' + option + counter + '-sPCB';
            checkboxElement.autocomplete = 'off';
            checkboxElement.value = option;
            PCBFilterElement.appendChild(checkboxElement);

            var labelElement = document.createElement('label');
            labelElement.className = 'btn btn-outline-info';
            labelElement.htmlFor = 'btn-check-' + option + counter + '-sPCB';
            labelElement.textContent = option;
            PCBFilterElement.appendChild(labelElement);
            counter++;
          });
          counter = 1;
          data.Driver.forEach(function (option) {
            var optionElement = document.createElement('option');
            optionElement.value = option;
            optionElement.textContent = option;

            driverElement.appendChild(optionElement);

            var checkboxElement = document.createElement('input');
            checkboxElement.type = 'checkbox';
            checkboxElement.className = 'btn-check';
            checkboxElement.id = 'btn-check-' + option + counter + '-sDriver';
            checkboxElement.autocomplete = 'off';
            checkboxElement.value = option;
            driverFilterElement.appendChild(checkboxElement);

            var labelElement = document.createElement('label');
            labelElement.className = 'btn btn-outline-info';
            labelElement.htmlFor = 'btn-check-' + option + counter + '-sDriver';
            labelElement.textContent = option;
            driverFilterElement.appendChild(labelElement);
            counter++;
          });
          counter = 1;
          data.Controller.forEach(function (option) {
            var optionElement = document.createElement('option');
            optionElement.value = option;
            optionElement.textContent = option;

            controllerElement.appendChild(optionElement);

            var checkboxElement = document.createElement('input');
            checkboxElement.type = 'checkbox';
            checkboxElement.className = 'btn-check';
            checkboxElement.id = 'btn-check-' + option + counter + '-sController';
            checkboxElement.autocomplete = 'off';
            checkboxElement.value = option;
            controllerFilterElement.appendChild(checkboxElement);

            var labelElement = document.createElement('label');
            labelElement.className = 'btn btn-outline-info';
            labelElement.htmlFor = 'btn-check-' + option + counter + '-sController';
            labelElement.textContent = option;
            controllerFilterElement.appendChild(labelElement);
            counter++;
          });
        })
        .catch(function (error) {
          console.log(error);
        });
    });

    var sliders = document.querySelectorAll('input[type="range"]');
    sliders.forEach(function (sl) {
      if (typeof sl != "undefined") {
        sl.addEventListener('change', function () {
          var label = document.querySelector("#" + this.id + "-value");
          label.textContent = "(" + sl.value + ")";
        });
      }
    });

  </script>
</body>

</html>